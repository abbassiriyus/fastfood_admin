(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[840],{2098:(e,a,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/users",function(){return s(7579)}])},3159:(e,a,s)=>{"use strict";s.d(a,{A:()=>o});var t=s(4848);s(6540);var r=s(6715),l=s(5418),n=s.n(l);let o=e=>{let{children:a}=e,s=(0,r.useRouter)(),l=e=>{s.push("/admin/".concat(e))};return(0,t.jsxs)("div",{className:n().layout,children:[(0,t.jsxs)("header",{className:n().header,children:[(0,t.jsxs)("div",{onClick:()=>window.location="/admin/",className:n().logo,children:["menu",(0,t.jsx)("span",{children:"go"})]}),(0,t.jsxs)("nav",{className:n().nav,children:[(0,t.jsx)("button",{onClick:()=>l("fastfood"),children:"Users"}),(0,t.jsx)("button",{onClick:()=>l("dashboard"),children:"Daromat"}),(0,t.jsx)("button",{onClick:()=>l("zakaz"),children:"Zakazlar"}),(0,t.jsx)("button",{onClick:()=>l("users"),children:"Offitsant"})]})]}),(0,t.jsx)("main",{className:n().content,children:a}),(0,t.jsx)("footer",{className:n().footer,children:"\xa92025 Created by Your Name"})]})}},4486:e=>{"use strict";e.exports="https://ipa.rce.uz"},7579:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>u});var t=s(4848),r=s(6540),l=s(3159),n=s(4335),o=s(4486),i=s.n(o),c=s(3750),d=s.n(c);function u(){let[e,a]=(0,r.useState)([]),[s,o]=(0,r.useState)(null),[c,u]=(0,r.useState)(null),[_,h]=(0,r.useState)(""),[m,p]=(0,r.useState)([]),[x,j]=(0,r.useState)([]),[b,y]=(0,r.useState)(!1),[g,N]=(0,r.useState)(!1),[k,T]=(0,r.useState)(0),[v,f]=(0,r.useState)(null),[S,U]=(0,r.useState)(0),C=async()=>{try{let e=(await n.A.get("".concat(i(),"/users"))).data.filter(e=>1===e.type);a(e),D(e)}catch(e){console.error("Foydalanuvchilarni olishda xatolik:",e)}};(0,r.useEffect)(()=>{C()},[]);let z=async(e,a)=>{try{let[s,t,r]=await Promise.all([n.A.get("".concat(i(),"/zakaz")),n.A.get("".concat(i(),"/zakaz_products")),n.A.get("".concat(i(),"/products"))]),l=s.data,o=t.data,c=r.data,d=l.filter(s=>{let t=new Date(s.created_at).toISOString().slice(0,10);return s.user_id===e&&t===a}).map(e=>{let a=o.filter(a=>a.zakaz_id===e.id).map(e=>{let a=c.find(a=>a.id===e.product_id);return{...e,name:a?a.name:"Nomaʼlum mahsulot",image:a?a.image:"Nomaʼlum mahsulot"}});return{...e,zakaz_products:a}});p(d)}catch(e){console.error("Zakazlarni olishda xatolik:",e)}},[w,I]=(0,r.useState)(0),L=e=>{f(a=>a===e?null:e)},D=e=>{let a=0,s=0;e.forEach(e=>{e.count_seen>0&&(s+=e.count_seen*e.prosent/100,a+=e.count_seen)}),T(s),I(a)},A=async e=>{try{let a=(await n.A.get("".concat(i(),"/tarixoylik"))).data.filter(a=>a.user_id===e);j(a),y(!0)}catch(e){console.error("Tarixoylikni olishda xatolik:",e)}},B=async(e,s)=>{if(window.confirm("Rostdan ham oylik bermoqchimisiz?"))try{let t=new FormData;t.append("user_id",e),t.append("price",1*s),await n.A.put("".concat(i(),"/users/").concat(e,"/reset-count"),{count_seen:0}),await n.A.post("".concat(i(),"/tarixoylik"),t,{headers:{"Content-Type":"multipart/form-data"}}),a(a=>a.map(a=>a.id===e?{...a,count_seen:0}:a))}catch(e){console.error("Oylikni berishda xatolik:",e)}},O=m.slice(10*S,(S+1)*10),E=Math.ceil(m.length/10);return(0,t.jsxs)(l.A,{children:[(0,t.jsxs)("div",{className:d().container,children:[(0,t.jsx)("h2",{children:"Foydalanuvchilar ro'yxati"}),(0,t.jsxs)("table",{className:d().table,children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"#"}),(0,t.jsx)("th",{children:"Ism"}),(0,t.jsx)("th",{children:"Telefon"}),(0,t.jsx)("th",{children:"foizi"}),(0,t.jsx)("th",{children:"Status"}),(0,t.jsx)("th",{children:"Oylik"}),(0,t.jsx)("th",{children:"Amal"})]})}),(0,t.jsx)("tbody",{children:e.map((e,a)=>(0,t.jsx)(r.Fragment,{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:a+1}),(0,t.jsx)("td",{children:e.username}),(0,t.jsx)("td",{children:e.phone_number||"Noma’lum"}),(0,t.jsx)("td",{children:e.prosent||"Noma’lum"}),(0,t.jsx)("td",{children:e.is_active?"Faol":"Nofaol"}),(0,t.jsx)("td",{children:e.count_seen?"".concat(e.count_seen*e.prosent/100," so‘m"):"Mavjud emas"}),(0,t.jsxs)("td",{children:[(0,t.jsx)("button",{className:d().button,onClick:()=>A(e.id),children:"Oylik tarixi"}),(0,t.jsx)("button",{className:d().button,onClick:()=>{u(e),N(!0),h(""),p([])},style:{marginLeft:"10px"},children:"Zakazlar"}),e.count_seen>0&&(0,t.jsx)("button",{className:"".concat(d().button," ").concat(d()["button--secondary"]),onClick:()=>B(e.id,e.count_seen*e.prosent/100),style:{marginLeft:"10px"},children:"Oylikni berish"})]})]})},e.id))})]}),(0,t.jsxs)("div",{className:d().totalSalaryWrapper,children:[(0,t.jsx)("h3",{children:"Tushan umumiy summa: "}),(0,t.jsx)("div",{className:d().totalSalary,children:(0,t.jsxs)("strong",{children:[w," so‘m"]})})]}),(0,t.jsxs)("div",{className:d().totalSalaryWrapper,children:[(0,t.jsx)("h3",{children:"Bugun berilishi kerak bo'lgan umumiy oylik: "}),(0,t.jsx)("div",{className:d().totalSalary,children:(0,t.jsxs)("strong",{children:[k.toLocaleString()," so‘m"]})})]})]}),g&&c&&(0,t.jsx)("div",{className:d().modalBackdrop,children:(0,t.jsxs)("div",{className:d().modal,children:[(0,t.jsxs)("h3",{className:d().modalTitle,children:[c.username," — Zakazlar"]}),(0,t.jsxs)("label",{className:d().label,children:["\uD83D\uDCC5 Sana tanlang:",(0,t.jsx)("input",{type:"date",value:_,className:d().dateInput,onChange:e=>{let a=e.target.value;h(a),z(c.id,a)}})]}),_&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("h4",{className:d().ordersTitle,children:[_," uchun zakazlar:"]}),(0,t.jsxs)("ul",{className:d().orderList,children:[O.map(e=>(0,t.jsxs)("div",{className:d().orderCard,children:[(0,t.jsxs)("div",{className:d().orderHeader,onClick:()=>L(e.id),children:["\uD83E\uDDFE Stol: ",e.number_stol," — Sana: ",e.created_at.slice(0,10)," — Soat: ",new Date(e.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})]}),v===e.id&&(0,t.jsx)("div",{className:d().orderContent,children:(0,t.jsx)("ul",{className:d().productList,children:e.zakaz_products.map(e=>(0,t.jsxs)("li",{className:d().productItem,children:[(0,t.jsx)("img",{src:e.image,className:d().productImage}),(0,t.jsxs)("span",{children:[e.name," — ",e.count," dona — ",e.price.toLocaleString()," so‘m"]})]},e.id))})})]},e.id)),(0,t.jsx)("div",{className:d().pagination,children:Array.from({length:E},(e,a)=>(0,t.jsx)("button",{className:"".concat(d().pageButton," ").concat(a===S?d().active:""),onClick:()=>U(a),children:a+1},a))})]})]}),(0,t.jsx)("button",{className:d().closeButton,onClick:()=>N(!1),children:"❌ Yopish"})]})}),b&&(0,t.jsx)("div",{className:d().modalBackdrop,children:(0,t.jsxs)("div",{className:d().modal,children:[(0,t.jsx)("h3",{className:d().modalTitle,children:"Berilgan oyliklar tarixi"}),(0,t.jsx)("div",{className:d().salaryHistoryWrapper,children:x.length>0?(0,t.jsx)("ul",{className:d().orderList,children:x.map((e,a)=>(0,t.jsxs)("li",{className:d().salaryHistoryItem,children:[(0,t.jsxs)("span",{children:[(0,t.jsxs)("strong",{children:[a+1,"."]})," ",new Date(e.created_at).toLocaleDateString()]})," ","— ",(0,t.jsxs)("span",{children:[e.price.toLocaleString()," so‘m"]})]},e.id))}):(0,t.jsx)("p",{children:"Hali oylik berilmagan."})}),(0,t.jsx)("button",{className:d().closeButton,onClick:()=>y(!1),children:"❌ Yopish"})]})})]})}},5418:e=>{e.exports={layout:"Layout_layout__Y0zgz",header:"Layout_header__3MyD7",nav:"Layout_nav__lgtID",logo:"Layout_logo__jEC1A",content:"Layout_content__EbiXf",footer:"Layout_footer__XhvoB"}},3750:e=>{e.exports={container:"UsersTable_container__yMtOe",table:"UsersTable_table__vTlg1",salaryRow:"UsersTable_salaryRow__GecNv",button:"UsersTable_button__462_d","button--secondary":"UsersTable_button--secondary__PvDVv",modalBackdrop:"UsersTable_modalBackdrop__TLnBI",modal:"UsersTable_modal__dgfn0",modalTitle:"UsersTable_modalTitle__cK2Xi",label:"UsersTable_label__EVzJu",dateInput:"UsersTable_dateInput__oA9AU",ordersTitle:"UsersTable_ordersTitle__l6Ko4",orderList:"UsersTable_orderList__1m_fp",orderItem:"UsersTable_orderItem__PfWXj",noOrders:"UsersTable_noOrders__IoZ8v",closeButton:"UsersTable_closeButton__WarAh",productList:"UsersTable_productList__Vuc6O",productItem:"UsersTable_productItem__9baD0",productImage:"UsersTable_productImage__fsq5C",productInfo:"UsersTable_productInfo__fI3ki",orderCard:"UsersTable_orderCard__Q31_B",orderHeader:"UsersTable_orderHeader__7n_Oo",orderContent:"UsersTable_orderContent__oLVzI",pagination:"UsersTable_pagination__zwriL",pageButton:"UsersTable_pageButton__thmAo",active:"UsersTable_active__wb9qP",salaryHistoryWrapper:"UsersTable_salaryHistoryWrapper__DDT6l",salaryHistoryItem:"UsersTable_salaryHistoryItem__R7BsA",totalSalary:"UsersTable_totalSalary__PtXnu",totalSalaryWrapper:"UsersTable_totalSalaryWrapper__76P_N"}},6715:(e,a,s)=>{e.exports=s(8440)}},e=>{var a=a=>e(e.s=a);e.O(0,[335,636,593,792],()=>a(2098)),_N_E=e.O()}]);